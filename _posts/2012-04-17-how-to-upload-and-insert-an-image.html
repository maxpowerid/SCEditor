---
layout: post
title: How to upload and insert an image
excerpt: Breif example of how to upload an image and then insert it
tags: [HTML, BBCode, demo, example, image]
categories:
    - Demo
    - BBCode
    - HTML
---
<h2>Image upload demo</h2>

<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"> </script>
<link rel="stylesheet" href="/minified/jquery.sceditor.min.css" type="text/css" media="all" />
<script type="text/javascript" src="/minified/jquery.sceditor.min.js"> </script>
<script>
$(document).ready(function() {
	$("#demo-image").sceditorBBCodePlugin({
		style: "/minified/jquery.sceditor.default.min.css",
		emoticons: {
			dropdown: {
				":)": "/emoticons/smile.png",
				":angel:": "/emoticons/angel.png",
				":angry:": "/emoticons/angry.png",
				"8-)": "/emoticons/cool.png",
				":'(": "/emoticons/cwy.png",
				":ermm:": "/emoticons/ermm.png",
				":D": "/emoticons/grin.png",
				"<3": "/emoticons/heart.png",
				":(": "/emoticons/sad.png",
				":O": "/emoticons/shocked.png",
				":P": "/emoticons/tongue.png",
				";)": "/emoticons/wink.png"
			},
			more: {
				":alien:": "/emoticons/alien.png",
				":blink:": "/emoticons/blink.png",
				":blush:": "/emoticons/blush.png",
				":cheerful:": "/emoticons/cheerful.png",
				":devil:": "/emoticons/devil.png",
				":dizzy:": "/emoticons/dizzy.png",
				":getlost:": "/emoticons/getlost.png",
				":happy:": "/emoticons/happy.png",
				":kissing:": "/emoticons/kissing.png",
				":ninja:": "/emoticons/ninja.png",
				":pinch:": "/emoticons/pinch.png",
				":pouty:": "/emoticons/pouty.png",
				":sick:": "/emoticons/sick.png",
				":sideways:": "/emoticons/sideways.png",
				":silly:": "/emoticons/silly.png",
				":sleeping:": "/emoticons/sleeping.png",
				":unsure:": "/emoticons/unsure.png",
				":woot:": "/emoticons/w00t.png",
				":wassat:": "/emoticons/wassat.png"
			},
			hidden: {
				":whistling:": "/emoticons/whistling.png",
				":love:": "/emoticons/wub.png"
			}
		}
	});

	window.sceditorInstance = $("#demo-image").data("sceditor");
});
</script>

<p><textarea style="width:600px; height:300px" id="demo-image">This [b]is[/b] [color=#ff0000]a[/color] [size=3]demo[/size] :).</textarea></p>
<form action="http://www.imageshack.us/redirect_api.php" method="post" enctype="multipart/form-data" target="upload">
	<p><label>Image: <input type="file" name="media" /></label></p>

	<p><label>Resize Image? <input type="checkbox" name="optimage" id="optimage" value="1" checked onclick="optsize.disabled=!this.checked"></label></p>

	<p><label>Size: <select name="optsize" id="optsize">
		<option value="resample">optimize without resizing</option>
		<option value="100x100">100x75 (avatar)</option>
		<option value="150x150">150x112 (thumbnail)</option>
		<option value="320x320">320x240 (for websites and email)</option>
		<option value="640x640">640x480 (for message boards)</option>
		<option value="800x800">800x600 (15-inch monitor)</option>
		<option value="1024x1024">1024x768 (17-inch monitor)</option>
		<option value="1280x1280">1280x1024 (19-inch monitor)</option>
		<option value="1600x1600">1600x1200 (21-inch monitor)</option>
	</select></label></p>

	<input type="hidden" name="key" value="346BFSTXbeec88bae13b92b2f4c8d888fdc8e420" />
	<input type="hidden" name="rembar" value="yes" />
	<input type="hidden" name="error_url" value="http://{{ site.domain }}/misc/imageshack-example.html" />
	<input type="hidden" name="success_url" value="http://{{ site.domain }}/misc/imageshack-example.html?url=%u&server=%s&bucket=%b&filename=%i" />

	<p><input type="submit" value="Upload" /></p>
</form>
<iframe style="visibility: hidden; height: 0; width: 0" id="upload" name="upload"></iframe>

<h2>Code behind it</h2>

<p>Quite a few people have asked how to upload and insert images into the editor so I've decided to make this little demo with the ImageShack API.</p>

<p>All that is really needed to insert an image is to call wysiwygEditorInsertHtml on the editor instance.</p>

<p>First, setup the editor with the upload form.</p>

{% highlight html %}
<script>$(document).ready(function() {
	$("textarea").sceditorBBCodePlugin({
		style: "/minified/jquery.sceditor.default.min.css"
	});

	window.sceditorInstance = $("textarea").data("sceditor");
});</script>

<textarea></textarea>
<form action="http://www.imageshack.us/redirect_api.php" method="post" enctype="multipart/form-data" target="upload">
	<p><label>Image: <input type="file" name="media" /></label></p>

	<p><label>Resize Image? <input type="checkbox" name="optimage" id="optimage" value="1" checked onclick="optsize.disabled=!this.checked"></label></p>

	<p><label>Size: <select name="optsize" id="optsize">
		<option value="resample">optimize without resizing</option>
		<option value="100x100">100x75 (avatar)</option>
		<option value="150x150">150x112 (thumbnail)</option>
		<option value="320x320">320x240 (for websites and email)</option>
		<option value="640x640">640x480 (for message boards)</option>
		<option value="800x800">800x600 (15-inch monitor)</option>
		<option value="1024x1024">1024x768 (17-inch monitor)</option>
		<option value="1280x1280">1280x1024 (19-inch monitor)</option>
		<option value="1600x1600">1600x1200 (21-inch monitor)</option>
	</select></label></p>

	<input type="hidden" name="key" value="DEVELOPER_KEY_HERE" />
	<input type="hidden" name="rembar" value="yes" />
	<input type="hidden" name="error_url" value="http://example.com/imageshack-example.html" />
	<input type="hidden" name="success_url" value="http://example.com/imageshack-example.html?url=%u&server=%s&bucket=%b&filename=%i" />

	<p><input type="submit" value="Upload" /></p>
</form>
<iframe style="visibility: hidden; height: 0; width: 0" id="upload" name="upload"></iframe>
{% endhighlight %}

<p>imageshack-example.html - Page redirected to by the ImageShack API. This will insert the HTML or show the error message.</p>

{% highlight html %}
<script type="text/javascript">
// Query strnig parser source: http://stevenbenner.com/2010/03/javascript-regex-trick-parse-a-query-string-into-an-object/
var queryString = {};
window.location.search.replace(
	new RegExp("([^?=&]+)(=([^&]*))?", "g"),
	function($0, $1, $2, $3) { queryString[$1] = $3; }
);

if(queryString.url)
{
	var img_url	= "http://img" + queryString.server + ".imageshack.us/img" + queryString.server + "/" + queryString.bucket + "/" + queryString.filename;
	var html	= "<a href=\"" + queryString.url + "\"><img src=\"" + img_url + "\" alt=\"Uploaded Image\" /></a>";
	parent.window.sceditorInstance.wysiwygEditorInsertHtml(html);
}
else if(queryString.message)
{
	alert(queryString.message);
}

</script>
{% endhighlight %}

<p>When upload is pressed it will upload the image to ImageShack via the iframe. When ImageShack redirects it will redirect within the iframe to imageshack-example.html which will handle showing the error/inserting the image.</p>
